<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | JobPortal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3a7bd5;
            --accent-color: #3a6073;
            --card-bg: rgba(255, 255, 255, 0.11);
        }
        body {
            margin: 0;
            font-family: 'Poppins', sans-serif;
            background: #101422;
            color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow: hidden;
        }
        .bg-names {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            z-index: 1;
            pointer-events: none;
        }
        .psychologist-name {
            position: absolute;
            font-weight: 600;
            opacity: 0.16;
            white-space: nowrap;
            user-select: none;
            will-change: transform, color;
            /* Animate color cycling */
            animation-name: color-cycle;
            animation-iteration-count: infinite;
            animation-timing-function: linear;
        }
        @keyframes color-cycle {
            0%   { color: #59c3c3;}
            14%  { color: #ffd166;}
            28%  { color: #db5461;}
            42%  { color: #45b29a;}
            57%  { color: #4a69bd;}
            71%  { color: #f26627;}
            85%  { color: #9d4edd;}
            100% { color: #59c3c3;}
        }
        /* Different drift keyframes */
        @keyframes drift-x {
            from { transform: translateX(0px); }
            to   { transform: translateX(100vw);}
        }
        @keyframes drift-move1 {
            0% { transform: translate(0, 0);}
            33% { transform: translate(16vw, 8vh);}
            66% { transform: translate(8vw, 22vh);}
            100%{ transform: translate(0, 0);}
        }
        @keyframes drift-move2 {
            0% { transform: translate(0, 0);}
            40% { transform: translate(-14vw, -11vh);}
            75% { transform: translate(-7vw, -18vh);}
            100%{ transform: translate(0, 0);}
        }
        @keyframes drift-move3 {
            0% { transform: translate(0, 0);}
            50% { transform: translate(11vw, -16vh);}
            100%{ transform: translate(0, 0);}
        }
        @keyframes drift-move4 {
            0% { transform: translate(0, 0);}
            44% { transform: translate(-9vw, 18vh);}
            100%{ transform: translate(0, 0);}
        }

        /* Login card styling */
        .login-card-container {
            position: relative;
            z-index: 5;
        }
        .login-card {
            background: var(--card-bg);
            backdrop-filter: blur(22px) saturate(145%);
            border: 1.3px solid rgba(255, 255, 255, 0.15);
            border-radius: 28px;
            padding: 2.5rem;
            width: 100%;
            max-width: 420px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.28);
            opacity: 0;
            transform: scale(0.5);
            border-radius: 50%;
            filter: blur(14px);
            animation: reveal-card 1.3s cubic-bezier(0.165,0.84,0.44,1) 0.4s forwards;
        }
        @keyframes reveal-card {
            to {
                opacity: 1;
                transform: scale(1);
                border-radius: 28px;
                filter: blur(0);
            }
        }
        .animated-item {
            opacity: 0;
            transform: translateY(24px) scale(0.98);
            animation: pop-in .83s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }
        .brand-section { animation-delay: 1.1s;}
        .form-group-1 { animation-delay: 1.25s;}
        .form-group-2 { animation-delay: 1.43s;}
        .btn-submit { animation-delay: 1.64s;}
        .register-link { animation-delay: 1.8s;}
        @keyframes pop-in {
            to { opacity: 1; transform: none;}
        }
        /* Brand styling */
        .brand-logo {
            width: 60px; height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            margin: 0 auto 1rem;
            background: linear-gradient(115deg, var(--primary-color), var(--accent-color));
            box-shadow: 0 0 20px rgba(58, 123, 213, 0.5);
        }
        .form-control {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.18);
            color: #eef5fc;
        }
        .form-control::placeholder { color: #bad7f2;}
        .form-control:focus {
            background: rgba(255,255,255,0.18);
            border-color: #68c3c3;
            box-shadow: 0 0 11px #68c3c357;
            color: #eef5fc;
        }
        .btn-primary {
            background: linear-gradient(45deg, var(--primary-color) 45%, var(--accent-color) 100%);
            border: none;
            transition: all .31s cubic-bezier(.33,1.29,.55,1);
        }
        .btn-primary:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 7px 24px rgba(58,123,213,0.24);
            background: linear-gradient(45deg, #bde0fe, #a7c7e7 90%);
            color: #151922 !important;
        }
        .shake { animation: shake-anim .5s cubic-bezier(.36,.07,.19,.97);}
        @keyframes shake-anim {
            10%, 90% { transform: translateX(-6px);}
            20%, 80% { transform: translateX(6px);}
            30%,50%,70% { transform: translateX(-8px);}
            40%,60% { transform: translateX(8px);}
        }
    </style>
</head>
<body>
    <div class="bg-names" id="nameContainer"></div>
    <div class="login-card-container">
        <div class="login-card" id="loginCard" data-has-error="{{ 'true' if get_flashed_messages(category_filter=['danger', 'error']) else 'false' }}">
            <div class="text-center mb-4 animated-item brand-section">
                <div class="brand-logo p-1">
  <img src="{{ url_for('static', filename='psilogo.gif') }}" alt="Know-Thyself Logo" class="img-fluid" style="width: 54px; height: 54px; object-fit: cover; border-radius: 50%;">
</div>

                <h1 class="h3">Welcome</h1>
                <p class="text-white-50">Enter the portal</p>
            </div>
            <form method="POST" novalidate>
                {{ form.hidden_tag() }}
                <div class="mb-3 animated-item form-group-1">
                    <label for="email_or_sid" class="form-label">Identifier</label>
                    {{ form.email_or_sid(class="form-control", id="email_or_sid", placeholder="Email or Student ID") }}
                </div>
                <div class="mb-4 animated-item form-group-2">
                    <label for="password" class="form-label">Passcode</label>
                    <div class="password-wrapper">
                        {{ form.password(class="form-control", id="password", placeholder="Enter your passcode") }}
                    </div>
                </div>
                <button type="submit" class="btn btn-primary w-100 py-2 fs-5 fw-bold animated-item btn-submit">Authenticate</button>
                <div class="text-center mt-4 animated-item register-link">
                    <p class="text-white-50">New here? <a href="{{ url_for('register') }}" class="fw-bold text-decoration-none text-white">Create an Identity</a></p>
                </div>
            </form>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 1. Fill background densely with many names
            const nameContainer = document.getElementById('nameContainer');
            const names = [
                // A much larger list for max coverage!
                'Sigmund Freud','Carl Jung','B.F. Skinner','Jean Piaget','Alfred Adler','Erik Erikson','Abraham Maslow',
                'Carl Rogers','Ivan Pavlov','Albert Bandura','Lev Vygotsky','William James','John Dewey','John Watson',
                'Anna Freud','Melanie Klein','Karen Horney','Wilhelm Wundt','Mary Ainsworth','Donald Winnicott','John Bowlby',
                'Rollo May','Aaron Beck','Viktor Frankl','Erich Fromm','Julian Rotter','Solomon Asch','Leon Festinger',
                'Stanley Milgram','Philip Zimbardo','Elizabeth Loftus','Martin Seligman','Howard Gardner','Richard Lazarus',
                'Noam Chomsky','Elliot Aronson','Daniel Kahneman','Amos Tversky','Henry Murray','James-Lange','William Glasser',
                'David McClelland','Gordon Allport','Hans Eysenck','Raymond Cattell','Nancy Chodorow','Paul Ekman','Francis Galton',
                'David Wechsler','Robert Sternberg','John Gottman','Mihaly Csikszentmihalyi','Henri Tajfel','Jerome Kagan',
                'Jerome Bruner','Albert Ellis','Fritz Perls','Alfred Binet','Aaron T. Beck','Joseph Wolpe','Harry Stack Sullivan',
                'Bruce Tuckman','Walter Mischel','Irvin Yalom','Charles Spearman','Lewis Terman','Seymour Epstein','Carol Dweck',
                'Daniel Goleman', 'Ellen Langer', 'Uri Bronfenbrenner', 'Edward Thorndike', 'Clifford Beers', 'Kurt Lewin',
                'David Rosenhan', 'Erving Goffman', 'John Garcia', 'George Kelly', 'Robert Plutchik', 'Paul Costa',
                'Robert McCrae', 'Daryl Bem', 'Walter Cannon', 'James Olds'
            ];
            // Number depends on viewport size: make sure there's enough for density
            const nameCount = Math.max(40, Math.floor(window.innerWidth * window.innerHeight / 25000));
            for (let i = 0; i < nameCount; i++) {
                const nameEl = document.createElement('span');
                nameEl.className = 'psychologist-name';
                nameEl.textContent = names[Math.floor(Math.random() * names.length)];
                // Distribute vertically and horizontally for max coverage
                nameEl.style.left = `${Math.random() * 94}vw`;
                nameEl.style.top = `${Math.random() * 92}vh`;
                nameEl.style.fontSize = `${Math.random() * 1.4 + 1.0}rem`;
                nameEl.style.opacity = (Math.random() * 0.3 + 0.19).toFixed(2);
                // Assign different drift and color-cycle animations
                const animationType = Math.ceil(Math.random() * 4);
                nameEl.style.animationName = `drift-move${animationType}, color-cycle`;
                nameEl.style.animationDuration = `${26 + Math.random()*24}s, ${(18 + Math.random()*18).toFixed(1)}s`;
                nameEl.style.animationDelay = `0s, ${(Math.random()*10).toFixed(2)}s`;
                nameEl.style.animationIterationCount = 'infinite, infinite';
                nameEl.style.animationDirection = 'alternate, alternate';
                nameContainer.appendChild(nameEl);
            }

            // 2. Shake the card on login error
            const loginCard = document.getElementById('loginCard');
            if (loginCard && loginCard.dataset.hasError === 'true') {
                loginCard.classList.add('shake');
                loginCard.addEventListener('animationend', () => {
                    loginCard.classList.remove('shake');
                }, { once: true });
            }
        });
    </script>
</body>
</html>
